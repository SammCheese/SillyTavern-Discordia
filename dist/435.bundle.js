export const __webpack_esm_id__=435;export const __webpack_esm_ids__=[435];export const __webpack_esm_modules__={4435(e,a,t){t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{default:()=>d});var n=t(5656),i=t(7140),l=t(9928),s=t(8466),c=e([l,s]);[l,s]=c.then?(await c)():c;const o=({avatar:e,chat:a,isSelected:t,onClick:r})=>{const{handleContextMenu:c}=(0,l.z)(a),o=(0,i.useCallback)(()=>{r?.(a)},[r,a]);return(0,n.jsx)("li",{className:"border-none list-none relative ms-1 select-none cursor-pointer rounded-lg hover:bg-lighter "+(t?"bg-lighter":""),id:`recent-chat-${a.file_id??a.file_name}`,title:a.file_id??a.file_name,onClick:o,onContextMenu:c,children:(0,n.jsx)("div",{className:"items-stretch flex w-full box-border",children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{flex:"1 1 auto",paddingRight:"8px",paddingLeft:"8px"},className:"items-center flex gap-2 min-w-0 overflow-hidden text-ellipsis whitespace-nowrap w-full",children:(0,n.jsxs)("div",{className:"h-12 items-center flex rounded-sm min-w-0 p-0",children:[a.is_group?(0,n.jsx)("div",{className:"me-3 flex shrink-0 justify-center",children:(0,n.jsx)(s.A,{height:36,width:36,rounded:100,groupId:a?.group?.toString()})}):(0,n.jsx)("img",{loading:"lazy",style:{flex:"0 0 auto"},className:"rounded-4xl h-9 w-9 object-cover flex me-3 justify-center",src:e}),(0,n.jsx)("div",{className:"truncate select-none",children:a?.file_id??a.file_name})]})}),(0,n.jsx)("div",{className:"items-center flex flex-row shrink-0 justify-end box-border ps-px-[16px]",children:(0,n.jsx)("div",{className:"self-center p-0 m-0 hidden me-2 pe-2.5",id:"close-chat-button",children:"x"})})]})})})},d=(0,i.memo)(o);r()}catch(e){r(e)}})},8466(e,a,t){t.a(e,async(e,r)=>{try{t.d(a,{A:()=>u});var n=t(5656),i=t(7140),l=t(3659).V;const{getThumbnailUrl:e,characters:s,default_avatar:c}=await l("@script"),{isValidUrl:o}=await l("@scripts/utils"),d=({groupItem:a,groupId:t,width:r=48,height:l=48,rounded:d=!1})=>{const u=(0,i.useMemo)(()=>{const a=new Map;return s.forEach(t=>{t.avatar&&"none"!==t.avatar&&a.set(t.avatar,e("avatar",t.avatar))}),a},[s]),h=(0,i.useMemo)(()=>{if(!a&&!t)return(0,n.jsx)("img",{src:c});if(!a&&t&&(a=SillyTavern.getContext().groups.find(e=>e.id.toString()===t.toString())),o(a?.avatar_url))return(0,n.jsx)("div",{className:"avatar",title:`[Group] ${a.name}`,children:(0,n.jsx)("img",{loading:"lazy",src:a.avatar_url})});const e=[];if(Array.isArray(a?.members))for(const t of a.members){const a=u.get(t);if(a&&e.push(a),e.length>4)break}const s=e.length;if(s<1)return(0,n.jsx)("img",{src:c});const h=(0,i.useMemo)(()=>"number"==typeof d?`${d}px`:d?"50%":void 0,[d]);return(0,n.jsx)("div",{className:`collage_${s} flex flex-wrap ${100===d?"full":""}`,title:`[Group] ${a?.name}`,style:{width:r,height:l,borderRadius:h},children:e.map((e,a)=>(0,n.jsx)("img",{className:`img_${a+1} object-cover`,src:e},a))})},[a,r,l,d,u]);return(0,n.jsx)(n.Fragment,{children:h})},u=(0,i.memo)(d);r()}catch(e){r(e)}},1)},9928(e,a,t){t.a(e,async(e,r)=>{try{t.d(a,{z:()=>x});var n=t(7140),i=t(2298),l=t(2711),s=t(6095),c=t(3659).V,o=t(9232).f;const{deleteCharacterChatByName:e,eventSource:d,closeCurrentChat:u,openCharacterChat:h}=await c("@script"),{deleteGroupChatByName:m,openGroupChat:f}=await c("@scripts/groupChats"),x=a=>{const{showContextMenu:t}=(0,n.useContext)(i.Kh),{openPopup:r}=(0,n.useContext)(s.uK),c=(0,n.useCallback)(async()=>{const{characters:t,characterId:r,groupId:n}=SillyTavern.getContext();if(a)try{if(null===n||r){let n=a.char_id??r;if(n||(n=t.findIndex(e=>e.avatar===a.avatar)),void 0===n||-1===n)return;await u(),await e(n.toString(),a.file_id)}else await u(),await m(n,a.file_name)}catch(e){o.error("Error deleting chat:",e)}finally{d.emit(l.V.HOME_BUTTON_CLICKED)}},[a]),x=(0,n.useCallback)(async()=>{if(a)if(a?.char_id)await h(a.char_id);else{const{groupId:e,characterId:t}=SillyTavern.getContext();null===e||t?await h(a?.file_id):await f(e,a?.file_name)}},[a]),p=(0,n.useCallback)(()=>{r(null,{title:"Confirm Deletion",confirmText:"Delete",confirmVariant:"danger",cancelText:"Cancel",description:`Are you sure you want to delete the chat "${a.file_name}"? This action cannot be undone.`,onConfirm:async()=>{await c()}})},[a,r,c]),g=(0,n.useMemo)(()=>[{label:"Open",onClick:x},{label:"---",variant:"separator"},{label:"Delete",variant:"danger",onClick:p}],[a,p]);return{handleContextMenu:(0,n.useCallback)(e=>{e.preventDefault(),t(e,g)},[g,t])}};r()}catch(e){r(e)}},1)}};
//# sourceMappingURL=435.bundle.js.map