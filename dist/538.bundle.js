export const __webpack_esm_id__=538;export const __webpack_esm_ids__=[538];export const __webpack_esm_modules__={2912(e,t,a){a.a(e,async(e,r)=>{try{a.d(t,{V:()=>g});var n=a(5656),i=a(7140),s=a(2298),l=a(9879),o=a(2711),c=a(6095),u=a(3659).V;const e=(0,i.lazy)(()=>Promise.resolve().then(a.bind(a,869))),d=(0,i.lazy)(()=>a.e(273).then(a.bind(a,8273))),{deleteCharacter:m,eventSource:h,closeCurrentChat:p}=await u("@script"),{deleteGroup:v}=await u("@scripts/groupChats"),g=t=>{const{showContextMenu:a}=(0,i.useContext)(s.Kh),{openModal:r}=(0,i.useContext)(l.Vs),{openPopup:u}=(0,i.useContext)(c.uK),g=(0,i.useCallback)(async()=>{try{if("character"===t.type){if(!t.item?.avatar)return;const{characterId:e,characters:a}=SillyTavern.getContext(),r=t.item.avatar.toString(),n=a.find(e=>e.avatar?.toString()===r);null!=e&&n&&a[e]===n&&await p(),await m(r,{deleteChats:!0})}else if("group"===t.type){if(!t?.id)return;await v(t.id.toString())}h.emit(o.V.ENTITY_CHANGED)}catch(e){console.error("Error deleting character:",e)}},[t]),x=(0,i.useCallback)(()=>{u(null,{title:"Confirm Deletion",confirmText:"Delete",confirmVariant:"danger",cancelText:"Cancel",description:`Are you sure you want to delete the ${"character"===t.type?"character":"group"} "${t.item?.name}"? This action cannot be undone.`,onCancel:()=>{},onConfirm:async()=>{await g()}})},[t,u,g]),f=(0,i.useCallback)(()=>{"character"===t.type?r((0,n.jsx)(e,{avatarName:t.item?.avatar.toString()||""})):"group"===t.type&&r((0,n.jsx)(d,{entity:t}))},[t,r]),b=(0,i.useMemo)(()=>[{label:t.item?.name||"Character",disabled:!0},{label:"---",variant:"separator"},{label:"Edit",onClick:f},{label:"---",variant:"separator"},{label:"Delete",variant:"danger",onClick:x}],[t.item?.name,f,x]);return{handleContextMenu:(0,i.useCallback)(e=>{e.preventDefault(),a(e,b)},[b,a])}};r()}catch(e){r(e)}},1)},8466(e,t,a){a.a(e,async(e,r)=>{try{a.d(t,{A:()=>d});var n=a(5656),i=a(7140),s=a(3659).V;const{getThumbnailUrl:e,characters:l,default_avatar:o}=await s("@script"),{isValidUrl:c}=await s("@scripts/utils"),u=({groupItem:t,width:a=48,height:r=48,rounded:s=!1})=>{const u=(0,i.useMemo)(()=>{if(!t)return(0,n.jsx)("img",{src:o});if(c(t.avatar_url))return(0,n.jsx)("div",{className:"avatar",title:`[Group] ${t.name}`,children:(0,n.jsx)("img",{loading:"lazy",src:t.avatar_url})});const i=[];if(Array.isArray(t?.members))for(const a of t.members){const t=l.findIndex(e=>e.avatar===a);if(-1!==t&&"none"!==l[t]?.avatar&&i.push(e("avatar",l[t]?.avatar||o)),4===i.length)break}const u=i.length;return u<1?(0,n.jsx)("img",{src:o}):(0,n.jsx)("div",{id:"group_avatars_template",className:`collage_${u} flex flex-wrap `,title:`[Group] ${t.name}`,style:{width:a,height:r,borderRadius:s?"50%":void 0},children:i.map((e,t)=>(0,n.jsx)("img",{className:`img_${t+1} object-cover`,src:e},t))})},[t,a,r,s]);return(0,n.jsx)(n.Fragment,{children:u})},d=(0,i.memo)(u);r()}catch(e){r(e)}},1)},8538(e,t,a){a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>m});var n=a(5656),i=a(7140),s=a(8466),l=a(2912),o=a(3659).V,c=e([s,l]);[s,l]=c.then?(await c)():c;const{getThumbnailUrl:u}=await o("@script"),d=({entity:e,isSelected:t,onClick:a,index:r})=>{const{handleContextMenu:o}=(0,l.V)(e),c=(0,i.useCallback)(()=>{a?.(e,r)},[a,e,r]),d=(0,i.useMemo)(()=>u("avatar",e.item?.avatar||e.id),[e]);return(0,n.jsxs)("div",{className:"flex m-0 relative w-full h-fit select-none group",onContextMenu:o,onClick:c,children:[(0,n.jsx)("div",{className:"absolute start-0 top-0 w-2 justify-start items-center flex h-full",children:(0,n.jsx)("span",{className:"w-2 absolute block transition-all ease-in-out duration-200 -ms-1 bg-white rounded-r "+(t?"h-8":"h-0 group-hover:h-6")})}),(0,n.jsx)("div",{className:"cursor-pointer w-full h-fit flex justify-center items-center",children:"group"===e.type?(0,n.jsx)(s.A,{groupItem:e.item,rounded:!0}):(0,n.jsx)("img",{loading:"lazy",alt:e.item?.name||"Character",className:"rounded-xl h-12 w-12 object-cover transition-all "+(t?"outline-1 outline-white":"group-hover:outline-1 group-hover:outline-white"),src:d})})]})},m=(0,i.memo)(d);r()}catch(e){r(e)}},1)}};
//# sourceMappingURL=538.bundle.js.map