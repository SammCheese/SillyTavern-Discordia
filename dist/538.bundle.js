export const __webpack_esm_id__=538;export const __webpack_esm_ids__=[538];export const __webpack_esm_modules__={2912(e,t,a){a.a(e,async(e,r)=>{try{a.d(t,{V:()=>v});var n=a(5656),i=a(7140),o=a(2298),s=a(9879),l=a(2711),c=a(6095),u=a(3659).V;const e=(0,i.lazy)(()=>Promise.resolve().then(a.bind(a,869))),m=(0,i.lazy)(()=>a.e(273).then(a.bind(a,8273))),{deleteCharacter:d,eventSource:h,closeCurrentChat:p}=await u("@script"),{deleteGroup:g}=await u("@scripts/groupChats"),v=t=>{const{showContextMenu:a}=(0,i.useContext)(o.Kh),{openModal:r}=(0,i.useContext)(s.Vs),{openPopup:u}=(0,i.useContext)(c.uK),v=(0,i.useCallback)(async()=>{try{if("character"===t.type){if(!t.item?.avatar)return;const{characterId:e,characters:a}=SillyTavern.getContext(),r=t.item.avatar.toString(),n=a.find(e=>e.avatar?.toString()===r);null!=e&&n&&a[e]===n&&await p(),await d(r,{deleteChats:!0})}else if("group"===t.type){if(!t?.id)return;await g(t.id.toString())}h.emit(l.V.ENTITY_CHANGED)}catch(e){console.error("Error deleting character:",e)}},[t]),x=(0,i.useCallback)(()=>{u(null,{title:"Confirm Deletion",confirmText:"Delete",confirmVariant:"danger",cancelText:"Cancel",description:`Are you sure you want to delete the ${"character"===t.type?"character":"group"} "${t.item?.name}"? This action cannot be undone.`,onCancel:()=>{},onConfirm:async()=>{await v()}})},[t,u,v]),f=(0,i.useCallback)(()=>{"character"===t.type?r((0,n.jsx)(e,{avatarName:t.item?.avatar.toString()||""})):"group"===t.type&&r((0,n.jsx)(m,{entity:t}))},[t,r]),y=(0,i.useMemo)(()=>[{label:t.item?.name||"Character",disabled:!0},{label:"---",variant:"separator"},{label:"Edit",onClick:f},{label:"---",variant:"separator"},{label:"Delete",variant:"danger",onClick:x}],[t.item?.name,f,x]);return{handleContextMenu:(0,i.useCallback)(e=>{e.preventDefault(),a(e,y)},[y,a])}};r()}catch(e){r(e)}},1)},8466(e,t,a){a.a(e,async(e,r)=>{try{a.d(t,{A:()=>m});var n=a(5656),i=a(7140),o=a(3659).V;const{getThumbnailUrl:e,characters:s,default_avatar:l}=await o("@script"),{isValidUrl:c}=await o("@scripts/utils"),u=({groupItem:t,groupId:a,width:r=48,height:o=48,rounded:u=!1})=>{const m=(0,i.useMemo)(()=>{const t=new Map;return s.forEach(a=>{a.avatar&&"none"!==a.avatar&&t.set(a.avatar,e("avatar",a.avatar))}),t},[s]),d=(0,i.useMemo)(()=>{if(!t&&!a)return(0,n.jsx)("img",{src:l});if(!t&&a&&(t=SillyTavern.getContext().groups.find(e=>e.id.toString()===a.toString())),c(t?.avatar_url))return(0,n.jsx)("div",{className:"avatar",title:`[Group] ${t.name}`,children:(0,n.jsx)("img",{loading:"lazy",src:t.avatar_url})});const e=[];if(Array.isArray(t?.members))for(const a of t.members){const t=m.get(a);if(t&&e.push(t),e.length>4)break}const s=e.length;if(s<1)return(0,n.jsx)("img",{src:l});const d=(0,i.useMemo)(()=>"number"==typeof u?`${u}px`:u?"50%":void 0,[u]);return(0,n.jsx)("div",{className:`collage_${s} flex flex-wrap ${100===u?"full":""}`,title:`[Group] ${t?.name}`,style:{width:r,height:o,borderRadius:d},children:e.map((e,t)=>(0,n.jsx)("img",{className:`img_${t+1} object-cover`,src:e},t))})},[t,r,o,u,m]);return(0,n.jsx)(n.Fragment,{children:d})},m=(0,i.memo)(u);r()}catch(e){r(e)}},1)},8538(e,t,a){a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>d});var n=a(5656),i=a(7140),o=a(8466),s=a(2912),l=a(3659).V,c=e([o,s]);[o,s]=c.then?(await c)():c;const{getThumbnailUrl:u}=await l("@script"),m=({entity:e,isSelected:t,onClick:a,index:r})=>{const{handleContextMenu:l}=(0,s.V)(e),c=(0,i.useCallback)(()=>{a?.(e,r)},[a,e,r]),m=(0,i.useMemo)(()=>u("avatar",e.item?.avatar||e.id),[e]);return(0,n.jsxs)("div",{className:"flex m-0 relative w-full h-fit select-none group",onContextMenu:l,onClick:c,children:[(0,n.jsx)("div",{className:"absolute start-0 top-0 w-2 justify-start items-center flex h-full",children:(0,n.jsx)("span",{className:"w-2 absolute block transition-all ease-in-out duration-200 -ms-1 bg-white rounded-r "+(t?"h-8":"h-0 group-hover:h-6")})}),(0,n.jsx)("div",{className:"cursor-pointer w-full h-fit flex justify-center items-center",children:"group"===e.type?(0,n.jsx)(o.A,{groupItem:e.item,rounded:!0}):(0,n.jsx)("img",{loading:"lazy",alt:e.item?.name||"Character",className:"rounded-xl h-12 w-12 object-cover transition-all "+(t?"outline-1 outline-white":"group-hover:outline-1 group-hover:outline-white"),src:m})})]})},d=(0,i.memo)(m);r()}catch(e){r(e)}},1)}};
//# sourceMappingURL=538.bundle.js.map