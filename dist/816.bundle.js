export const __webpack_esm_id__=816;export const __webpack_esm_ids__=[809,816];export const __webpack_esm_modules__={816(e,t,n){n.a(e,async(e,a)=>{try{n.r(t),n.d(t,{default:()=>x});var o=n(5656),s=n(7140),l=n(8699),i=n(7809),r=n(1813),c=n(5822).V,d=e([r]),u=d.then?(await d)():d;r=u[0];const h=(0,s.lazy)(()=>n.e(53).then(n.bind(n,6053))),b=(0,s.lazy)(()=>n.e(480).then(n.bind(n,5480))),g=await c("@script"),{CONNECT_API_MAP:v}=g,p=[{value:"textgenerationwebui",label:"Text Completion",short:"tc"},{value:"openai",label:"Chat Completion",short:"cc"},{value:"novel",label:"NovelAI",short:"na"},{value:"koboldhorde",label:"AI Horde",short:"ah"},{value:"kobold",label:"KoboldAI Classic",short:"kc"}],x=()=>{const{profiles:e,selectedProfileId:t,getCurrentApi:n,setCurrentApi:a,setSelectedProfile:c}=(0,r.H)(),[d,u]=(0,s.useState)(()=>n());(0,s.useEffect)(()=>{u(n())},[t]);const g=(0,s.useMemo)(()=>{const e={};return Object.entries(v).forEach(([t,n])=>{const a=n.selected;e[a]||(e[a]=[]),e[a].push({name:t,...n})}),e},[v]),x=(0,s.useMemo)(()=>{switch(d){case"kobold":return(0,o.jsx)("div",{children:"Kobold API Connection Settings"});case"openai":return(0,o.jsx)("div",{children:"OpenAI API Connection Settings"});case"novel":return(0,o.jsx)("div",{children:"Novel API Connection Settings"});case"textgenerationwebui":return(0,o.jsx)(b,{entries:g[d]},t);case"koboldhorde":return(0,o.jsx)("div",{children:"Kobold Horde API Connection Settings"});default:return(0,o.jsx)("div",{children:"No connection settings available for the selected API."})}},[d,t,g]),f=(0,s.useCallback)(()=>e.map(e=>({value:e.id??"",label:e.name??""})),[e]);return(0,o.jsx)(h,{title:"Connection Settings",children:(0,o.jsxs)("div",{style:{maxHeight:"80vh"},className:"p-4 space-y-4 overflow-auto flex flex-col",children:[(0,o.jsx)("h2",{children:"Profile"}),(0,o.jsx)(l.A,{options:f(),value:t,onChange:t=>{c(t);const n=e.find(e=>e.id===t)?.mode,o=p.find(e=>e.short===n)?.value;o&&(a(o),u(o))}}),(0,o.jsx)(i.default,{}),(0,o.jsx)("h2",{children:"API"}),(0,o.jsx)(l.A,{options:p,value:d,onChange:e=>{const t=e;a(t),u(t)}}),(0,o.jsx)(i.default,{}),(0,o.jsx)("div",{className:"settings-section",children:x})]})})};a()}catch(e){a(e)}},1)},1813(e,t,n){n.a(e,async(e,a)=>{try{n.d(t,{H:()=>h});var o=n(7140),s=n(5822).V;const{lodash:e}=SillyTavern.libs,l=e,{getContext:i}=SillyTavern,{changeMainAPI:r,saveSettingsDebounced:c,eventSource:d,event_types:u}=await s("@script"),h=()=>{const[e,t]=(0,o.useState)(()=>i().extensionSettings.connectionManager.profiles||[]),[n,a]=(0,o.useState)(()=>i().extensionSettings.connectionManager.selectedProfile||""),s=()=>e.find(e=>e.id===n),h=(0,o.useCallback)(()=>i().mainApi,[]),b=(0,o.useCallback)(e=>{t(e),i().extensionSettings.connectionManager.profiles=e},[]),g=(0,o.useCallback)(e=>{a(e),i().extensionSettings.connectionManager.selectedProfile=e,d.emit(u.CONNECTION_PROFILE_LOADED,e)},[]),v=(0,o.useCallback)(e=>{try{if(1!==r.length)throw new Error("changeMainAPI has unexpected signature, attempting fallback");r(e)}catch{console.warn("Failed to change main API via function, falling back to DOM"),$("#main_api").val(e).trigger("change")}c()},[]);return{profiles:e,selectedProfileId:n,selectedProfile:s(),updateCurrentProfile:(...t)=>{const n=s();if(!n)return;const a=Object.assign({},n,...t),o=e.map(e=>e.id===n.id?a:e);b(o),c(),l.debounce(()=>{d.emit(u.CONNECTION_PROFILE_UPDATED,a)},300)()},getCurrentApi:h,setProfiles:b,setCurrentApi:v,setSelectedProfile:g}};a()}catch(e){a(e)}},1)},7809(e,t,n){n.r(t),n.d(t,{default:()=>o});var a=n(5656);const o=(0,n(7140).memo)(({width:e="w-full",className:t=""})=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},className:`${e} h-px my-2 mx-auto ${t}`})}))},8699(e,t,n){n.d(t,{A:()=>s});var a=n(5656),o=n(7140);const s=(0,o.memo)(({options:e=[],value:t,onChange:n,disabled:s})=>{const l=(0,o.useCallback)(e=>{n&&n(e.target.value)},[n]);return(0,a.jsx)("select",{className:"border border-gray-300 rounded bg-white disabled:bg-gray-100 disabled:cursor-not-allowed",value:t,onChange:l,disabled:s,children:e.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})})}};
//# sourceMappingURL=816.bundle.js.map