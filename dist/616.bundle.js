export const __webpack_esm_id__=616;export const __webpack_esm_ids__=[616];export const __webpack_esm_modules__={1616(e,t,n){n.a(e,async(e,a)=>{try{n.r(t),n.d(t,{default:()=>H});var i=n(5656),s=n(7140),r=n(8677),o=n(5987),c=n(5277),l=n(6916),d=n(128),h=n(7426),u=n(9488),x=n(7754),p=n(8618),C=n(3659).V,m=n(9232).f,v=e([r,o,h]);[r,o,h]=v.then?(await v)():v;const b=(0,s.lazy)(()=>n.e(608).then(n.bind(n,1608))),w=(0,s.lazy)(()=>n.e(435).then(n.bind(n,4435))),y=(0,s.lazy)(()=>n.e(722).then(n.bind(n,7722))),g=(0,s.lazy)(()=>n.e(148).then(n.bind(n,148))),f=(0,s.lazy)(()=>n.e(617).then(n.bind(n,6617))),j=(0,s.lazy)(()=>n.e(43).then(n.bind(n,1043))),_=(0,s.lazy)(()=>n.e(654).then(n.bind(n,1273))),k=(0,s.lazy)(()=>n.e(35).then(n.bind(n,4273))),N=(0,s.lazy)(()=>n.e(761).then(n.bind(n,9761))),{doNewChat:S,eventSource:z,event_types:A}=await C("@script"),I=({icons:e,chats:t,recentChats:n,setOpen:a,isLoadingChats:C=!1,isInitialLoad:v=!0})=>{const[I,H]=(0,s.useState)("recent"),{openPage:T}=(0,r.N5)(),{setSearchQuery:L}=(0,l.SQ)(),{openChat:G,isSelectedChat:P}=(0,h.e)(),W=(0,s.useCallback)(e=>{const t=e.id;switch(t){case"#advanced-formatting-button":T((0,i.jsx)(N,{}));break;case"#extensions-settings-button":T((0,i.jsx)(g,{}));break;case"#WI-SP-button":T((0,i.jsx)(f,{}));break;case"#backgrounds-button":T((0,i.jsx)(j,{}));break;case"#persona-management-button":T((0,i.jsx)(_,{}));break;case"#rightNavHolder":T((0,i.jsx)(k,{}));break;default:m.log(`No action defined for icon with id: ${t}`)}},[T]),E=(0,s.useCallback)(async e=>{await G(e),window.innerWidth<=1e3&&a(!1)},[G,a]),M=(0,s.useCallback)(()=>{S(),window.innerWidth<=1e3&&a(!1)},[a]),B=(0,s.useMemo)(()=>e?.filter(e=>!e.showInProfile),[e]),D=(0,s.useCallback)(e=>{L(e)},[L]),Q=(0,s.useMemo)(()=>"recent"===I?n:t,[t,n,I]);(0,s.useEffect)(()=>{const e=()=>{const{characterId:e,groupId:t}=SillyTavern.getContext();H(void 0!==e||null!==t?"chat":"recent")};return z.on(A.CHAT_CHANGED,e),()=>{z.removeListener(A.CHAT_CHANGED,e)}},[]);const R="recent"===I?"Recent Chats":"Chats";return(0,i.jsx)(d.A,{children:(0,i.jsxs)("div",{id:"channel-container",className:"px-1 select-none",children:[(0,i.jsx)(y,{onInput:D}),(0,i.jsx)(b,{}),(0,i.jsx)("div",{id:"channel-header",children:(0,i.jsx)("div",{id:"channel-icons-container",children:B?.map((e,t)=>(0,i.jsx)(p.A,{icon:e,onClick:W},e.id||t))})}),(0,i.jsx)("div",{id:"channel-divider",className:"divider"}),(0,i.jsx)("div",{className:"section-header",children:R}),(0,i.jsx)("div",{id:"channel-list",children:(0,i.jsxs)("div",{id:"channels-list-container",children:[v&&(0,i.jsx)(u.z,{borderRadius:"8px",width:"100%",baseColor:"#202025",highlightColor:"#444449",enableAnimation:!0,duration:1,children:(0,i.jsx)(u.A,{count:5,height:48,className:"mx-auto my-2 w-full"})}),Q.length>50?(0,i.jsx)(c.B8,{rowComponent:({index:e,style:n})=>{const a=t[e];return(0,i.jsx)("div",{style:n,children:(0,i.jsx)(w,{chat:a,onClick:E,isSelected:P(a),avatar:(0,o.yN)({chat:a})})})},rowCount:Q.length,rowHeight:48,rowProps:{},overscanCount:5,style:{width:"100%"}}):Q.map((e,t)=>(0,i.jsx)(w,{chat:e,onClick:E,isSelected:P(e),avatar:(0,o.yN)({chat:e})},e.file_id||t)),!C&&"chat"===I&&(0,i.jsx)("div",{className:"flex justify-center px-1",children:(0,i.jsx)(x.A,{onClick:M})})]})})]})})},H=(0,s.memo)(I);a()}catch(e){a(e)}},1)},7426(e,t,n){n.a(e,async(e,a)=>{try{n.d(t,{e:()=>h});var i=n(7140),s=n(5987),r=n(3659).V,o=e([s]),c=o.then?(await o)():o;s=c[0];const{openCharacterChat:l}=await r("@script"),{openGroupChat:d}=await r("@scripts/groupChats");function h(){const e=(0,i.useCallback)(e=>{try{const t=e.file_id??e.file_name;return SillyTavern.getContext().chatId===t}catch{return!1}},[]),t=(0,i.useCallback)(e=>{const{characterId:t,groupId:n}=SillyTavern.getContext();return(void 0!==t||null!==n)&&(void 0!==t&&e?t==e:null!==n&&e?n==e:void 0!==t||null!==n)},[]);return{openChat:(0,i.useCallback)(async n=>{if(!n)return;if(e(n))return;const a=t();if(a){const e=void 0===n?.file_id;if(e){const{groupId:e}=SillyTavern.getContext();await d(e,n.file_name)}else e||await l(n.file_id);return}a||(n.is_group?await(0,s.eS)({id:n.group,chat_id:n.file_name}):void 0!==n?.char_id&&await(0,s.yG)(n.char_id,n.file_id))},[e,t]),isSelectedChat:e}}a()}catch(u){a(u)}},1)},7754(e,t,n){n.d(t,{A:()=>s});var a=n(5656),i=n(7140);const s=(0,i.memo)(({onClick:e})=>{const t=(0,i.useCallback)(()=>{e()},[e]);return(0,a.jsx)("button",{className:"w-full my-2 outline-dashed outline-1 cursor-pointer outline-gray-600 h-12 flex items-center justify-center rounded-md bg-discordia hover:bg-base-discordia-lighter  transition-colors",onClick:t,title:"Start a New Chat",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})},8618(e,t,n){n.d(t,{A:()=>s});var a=n(5656),i=n(7140);const s=(0,i.memo)(({icon:e,onClick:t})=>{const n=(0,i.useCallback)(()=>{t&&t(e)},[t,e]);return(0,a.jsxs)("div",{className:"py-2 px-2.5 select-none cursor-pointer font-bold rounded-md mr-1 w-full flex items-center gap-2 group",title:e.title,onClick:n,children:[(0,a.jsx)("div",{style:{fontSize:"28px"},className:`${e.className} group-hover:opacity-100`}),(0,a.jsx)("div",{className:"group-hover:text-white truncate text-gray-500",children:e.title})]})})}};
//# sourceMappingURL=616.bundle.js.map