export const __webpack_esm_id__=44;export const __webpack_esm_ids__=[44,73,345,713,809];export const __webpack_esm_modules__={44(e,l,a){a.a(e,async(e,r)=>{try{a.r(l),a.d(l,{default:()=>w});var s=a(5656),n=a(7140),t=a(5599),o=a(2332),i=a(1778),c=a(4345),d=a(901),u=a(7809),m=a(8699),h=a(1073),x=a(7713),p=a(8036),f=a(7845),b=a(5822).V,g=e([d,p,f]);[d,p,f]=g.then?(await g)():g;const{deleteGroup:v}=await b("@scripts/groupChats"),{getContext:j}=SillyTavern,w=({entity:e})=>{const[l,a]=(0,n.useState)(e.item||null),{closeModal:r}=(0,n.useContext)(i.Vs);(0,n.useEffect)(()=>{a(e.item||null)},[e]);const b=(0,n.useCallback)(()=>{r()},[r]),g=(0,n.useCallback)(async()=>{e?.id&&(await v(e.id.toString()),r())},[e,r]),w=(0,n.useCallback)(async()=>{if(!e?.id||!l)return;const a=j().groups.findIndex(l=>l.id===e.id);-1!==a&&(j().groups[a]=l),await(0,f.B)(l,!0),r()},[e,l,r]),N=(0,n.useMemo)(()=>{if(!l?.members)return[];const e=[];for(const a of l.members){if(!a)continue;const l=j().characters.find(e=>e.avatar===a);l&&e.push(l)}return e},[l]);return(0,s.jsxs)(o.A,{children:[(0,s.jsx)(o.A.Header,{children:"Edit Group"}),(0,s.jsxs)(o.A.Content,{children:[(0,s.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,s.jsx)("div",{className:"shrink-0 w-16 h-16",children:(0,s.jsx)(d.A,{groupItem:e.item,width:64,height:64,rounded:!0})}),(0,s.jsxs)("div",{className:"flex flex-col grow",children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"Group Name"}),(0,s.jsx)(c.default,{defaultValue:e.item?.name||"",onChange:()=>{}})]})]}),(0,s.jsx)(u.default,{className:"my-4"}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col  gap-2",children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"Member Order:"}),(0,s.jsx)(m.A,{value:l.generation_mode,options:[{label:"Manual",value:2},{label:"Natural order",value:0},{label:"List Order",value:1},{label:"Pooled Order",value:3}]})]}),(0,s.jsxs)("div",{className:"flex flex-col  gap-2",children:[(0,s.jsx)("label",{className:"block mb-2 font-medium",children:"Generation Handling:"}),(0,s.jsx)(m.A,{value:l.generation_mode,options:[{label:"Swap character cards",value:0},{label:"Join character cards (exclude muted)",value:1},{label:"Join character cards (include muted)",value:2}]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(h.default,{label:"Allow Self responses",checked:l.allow_self_responses}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(h.default,{label:"Auto Mode",checked:l.allow_self_responses}),(0,s.jsx)(c.default,{type:"number",placeholder:"5",value:l.auto_mode_delay,onChange:()=>{}})]}),(0,s.jsx)(h.default,{label:"Hide Muted Members Sprites",checked:!1}),(0,s.jsx)(h.default,{label:"Universal Tracker",checked:!1})]}),(0,s.jsx)("div",{children:(0,s.jsx)(x.default,{title:"Current Members",children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsx)(p.A,{members:N,onOrderChange:(e,r)=>{const s=l?.members||[],n=s.indexOf(e.avatar||"");if(-1===n)return;const t="up"===r?n-1:n+1;if(t<0||t>=s.length)return;const o=[...s],i=o[n];o[n]=o[t]??"",o[t]=i??"",a(e=>e?{...e,members:o}:e)},onRemoveMember:e=>{const r=(l?.members||[]).filter(l=>l!==e.avatar);a(e=>e?{...e,members:r}:e)},onOpenMemberProfile:e=>{console.log("Open profile for character:",e)}})})})}),(0,s.jsx)("div",{children:(0,s.jsx)(x.default,{title:"Add Members",children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:"TODO"})})})]})]}),(0,s.jsxs)(o.A.Footer,{children:[(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(t.A,{look:t.m.DANGER,onClick:g,children:"Delete"})}),(0,s.jsx)(t.A,{look:t.m.TRANSPARENT,onClick:b,children:"Cancel"}),(0,s.jsx)(t.A,{onClick:w,children:"Save"})]})]})};r()}catch(e){r(e)}},1)},1073(e,l,a){a.r(l),a.d(l,{default:()=>n});var r=a(5656),s=a(7140);const n=(0,s.memo)(({label:e,checked:l=!1,onChange:a})=>{const[n,t]=(0,s.useState)(l),o=(0,s.useCallback)(e=>{e.stopPropagation();const l=!n;t(l),a&&a(l)},[n,a]);return(0,s.useEffect)(()=>{t(l)},[l]),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("label",{className:"inline-flex items-center cursor-pointer relative",children:[(0,r.jsx)("input",{type:"checkbox",className:"appearance-none opacity-0 w-6 h-6 left-0 m-0 p-0 top-0",style:{height:"24px !important",width:"24px !important",position:"absolute"},checked:n,onChange:o}),(0,r.jsx)("div",{className:`w-6 h-6  rounded flex items-center justify-center cursor-pointer ${n?"border-blurple":"border-white"} hover:border-blurple border-2`,style:{backgroundColor:n?"var(--color-blurple)":"transparent",border:n?"none":"2px solid var(--color-white)",transition:"all 0.2s ease-in-out"},children:(0,r.jsx)("svg",{"aria-hidden":"true",role:"img",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{fill:n?"white":"transparent",fillRule:"evenodd",d:"M19.06 6.94a1.5 1.5 0 0 1 0 2.12l-8 8a1.5 1.5 0 0 1-2.12 0l-4-4a1.5 1.5 0 0 1 2.12-2.12L10 13.88l6.94-6.94a1.5 1.5 0 0 1 2.12 0Z",clipRule:"evenodd"})})}),(0,r.jsx)("span",{className:"ml-2 text-gray-200",children:e})]})})})},2332(e,l,a){a.d(l,{A:()=>d});var r=a(5656),s=a(7140);const n=(0,s.memo)(({children:e})=>(0,r.jsx)("div",{className:"p-4 flex-1 overflow-y-auto min-h-0 custom-scrollbar",children:e})),t=(0,s.memo)(({children:e})=>(0,r.jsx)("div",{className:"rounded-b-lg flex shrink-0 justify-end space-x-2 p-4 border-t border-gray-700 w-full bg-base-discordia",children:e}));var o=a(1778);const i=(0,s.memo)(({title:e,onClose:l,children:a,canClose:n=!0})=>{const{closeModal:t}=(0,s.useContext)(o.Vs);return(0,r.jsxs)("div",{className:"px-4 py-4 shrink-0 border-b border-gray-700 flex items-center justify-between w-full",children:[(0,r.jsx)("div",{className:"text-lg font-semibold m-0",children:e??a}),(0,r.jsx)("div",{className:"flex items-center",children:n&&(0,r.jsx)("button",{onClick:()=>{l&&l(),t()},className:"text-gray-400  hover:text-white cursor-pointer focus:outline-none","aria-label":"Close modal",children:"âœ•"})})]})}),c=({children:e,className:l=""})=>(0,r.jsx)("div",{className:`flex flex-col w-full h-full\n        bg-base-discordia rounded-lg shadow-2xl border border-gray-700\n        overflow-hidden ${l}`,children:e});c.Header=i,c.Content=n,c.Footer=t;const d=c},4345(e,l,a){a.r(l),a.d(l,{default:()=>n});var r=a(5656),s=a(7140);const n=(0,s.memo)(({placeholder:e="",defaultValue:l="",value:a,label:n="",onChange:t,style:o,disabled:i=!1,id:c="",type:d="text",growHeight:u=!1,maxHeight:m=160})=>{const h=a??l??"",x=(0,s.useRef)(null),p=(0,s.useCallback)(e=>{t(e.target.value)},[t]);return(0,s.useEffect)(()=>{u&&x.current&&(x.current.style.height="auto",x.current.style.height=`${Math.min(x.current.scrollHeight,m)}px`)},[h,u,m]),(0,r.jsxs)("div",{className:"flex flex-col w-full gap-1 ",style:o,children:[n&&(0,r.jsx)("label",{className:"text-sm font-medium mb-1",htmlFor:c,children:n}),u?(0,r.jsx)("textarea",{ref:x,id:c,disabled:i,style:u?{maxHeight:`${m}px`,overflowY:"auto"}:void 0,className:"input-field w-full px-3 py-2 bg-input-bg rounded-md outline outline-input-outline focus:ring-2 focus:ring-input-ring resize-none text-wrap wrap-break-word",placeholder:e,value:h,onChange:p,rows:1}):(0,r.jsx)("input",{contentEditable:u,id:c,disabled:i,className:"input-field w-full px-3 py-2 bg-input-bg rounded-md outline outline-input-outline focus:ring-2 focus:ring-input-ring",placeholder:e,type:d,value:h,onChange:p})]})})},5599(e,l,a){a.d(l,{A:()=>t,m:()=>r});var r,s=a(5656),n=a(7140);!function(e){e.DANGER="danger",e.PRIMARY="primary",e.SECONDARY="secondary",e.TRANSPARENT="transparent"}(r||(r={}));const t=(0,n.memo)(({label:e,onClick:l,children:a,disabled:t=!1,look:o=r.PRIMARY})=>{const i=(0,n.useCallback)(()=>{!t&&l&&l()},[t,l]),c=(0,n.useCallback)(()=>{switch(o){case r.DANGER:return"bg-red-600 hover:bg-red-700 border-red-700";case r.SECONDARY:return"bg-gray-600 hover:bg-gray-700 border-gray-700";case r.PRIMARY:return"hover:bg-blurple-lighter bg-blurple border-blurple";case r.TRANSPARENT:return"bg-transparent hover:border-blurple border-white";default:return"hover:bg-blurple-lighter bg-blurple border-blurple"}},[o]),d=(0,n.useMemo)(()=>c(),[c]);return(0,s.jsx)("button",{className:`px-4 py-2 text-white font-bold border cursor-pointer rounded disabled:opacity-50 ${d}`,onClick:i,disabled:t,children:e||a})})},7713(e,l,a){a.r(l),a.d(l,{Accordion:()=>n,default:()=>t});var r=a(5656),s=a(7140);const n=({title:e,isOpen:l=!1,onToggle:a,children:n})=>{const[t,o]=(0,s.useState)(l),i=(0,s.useCallback)(()=>{o(!t),a&&a()},[t,a]);return(0,r.jsxs)("div",{className:"accordion rounded mb-4 border border-base-discordia-lighter overflow-hidden",children:[(0,r.jsxs)("button",{className:"accordion-header cursor-pointer w-full flex justify-between items-center p-2 bg-accordion-header hover:bg-lighter transition-colors duration-200",onClick:i,children:[(0,r.jsx)("span",{className:"text-lg font-medium",children:e}),(0,r.jsx)("span",{children:t?(0,r.jsx)("div",{className:"fa fa-chevron-up"}):(0,r.jsx)("div",{className:"fa fa-chevron-down"})})]}),t&&(0,r.jsx)("div",{className:"accordion-content p-4 bg-input-bg",children:n})]})},t=(0,s.memo)(n)},7809(e,l,a){a.r(l),a.d(l,{default:()=>s});var r=a(5656);const s=({width:e="w-full",className:l=""})=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},className:`${e} h-px my-2 ml-auto mr-auto ${l}`})})},7845(e,l,a){a.a(e,async(e,r)=>{try{a.d(l,{B:()=>o});var s=a(5822).V;const{getRequestHeaders:n,getCharacters:t}=await s("@script");async function o(e,l=!0){await fetch("/api/groups/edit",{method:"POST",headers:n(),body:JSON.stringify(e)}),l&&await t()}r()}catch(i){r(i)}},1)},8036(e,l,a){a.a(e,async(e,r)=>{try{a.d(l,{A:()=>c});var s=a(5656),n=a(7140),t=a(5822).V;const{getThumbnailUrl:e}=await t("@script"),o=({member:l,onRemove:a,onOpenProfile:r,onOrderChange:t})=>{const o=(0,n.useMemo)(()=>e("avatar",l.avatar||"user-default.png"),[l]);return(0,s.jsxs)("div",{className:"flex flex-row items-center gap-4 p-2 border rounded-md",children:[(0,s.jsx)("div",{className:"w-10 h-10",children:(0,s.jsx)("img",{loading:"lazy",src:o,alt:l.name||"Member Avatar",className:"w-full h-full rounded-full object-cover"})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:l.name||"Unnamed Member"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Tags: ",l.tags.join(", ")||"None"]})]}),(0,s.jsxs)("div",{className:"ml-auto flex flex-row gap-2 items-center",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1 w-6 items-center",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{title:"Move Up",className:"fa fa-solid fa-arrow-up cursor-pointer",onClick:e=>{e.stopPropagation(),t&&t(l,"up")}})}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{title:"Move Down",className:"fa fa-solid fa-arrow-down cursor-pointer",onClick:e=>{e.stopPropagation(),t&&t(l,"down")}})})]}),(0,s.jsx)("div",{className:"flex flex-col gap-1 w-6 items-center",children:(0,s.jsx)("div",{title:"Open Character Card",className:"fa fa-solid fa-user cursor-pointer",onClick:e=>{e.stopPropagation(),r&&r(l)}})}),(0,s.jsx)("div",{className:"flex flex-col gap-1 w-6 items-center",children:(0,s.jsx)("div",{title:"Remove Member",className:"fa fa-solid fa-trash cursor-pointer text-red-500",onClick:e=>{e.stopPropagation(),a&&a(l)}})})]})]})},i=({members:e,onOrderChange:l,onRemoveMember:a,onOpenMemberProfile:r})=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:e&&e.map((e,n)=>(0,s.jsx)(o,{member:e,onOrderChange:l,onRemove:a,onOpenProfile:r},e.avatar||n))})}),c=(0,n.memo)(i);r()}catch(e){r(e)}},1)},8699(e,l,a){a.d(l,{A:()=>n});var r=a(5656),s=a(7140);const n=(0,s.memo)(({options:e=[],value:l,onChange:a,disabled:n})=>{const t=(0,s.useCallback)(e=>{a&&a(e.target.value)},[a]);return(0,r.jsx)("select",{className:"border border-gray-300 rounded bg-white disabled:bg-gray-100 disabled:cursor-not-allowed",value:l,onChange:t,disabled:n,children:e.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})})}};
//# sourceMappingURL=44.bundle.js.map