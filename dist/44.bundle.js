export const __webpack_esm_id__=44;export const __webpack_esm_ids__=[44,73,809];export const __webpack_esm_modules__={44(e,a,l){l.a(e,async(e,s)=>{try{l.r(a),l.d(a,{default:()=>w});var r=l(5656),t=l(7140),n=l(5599),o=l(2332),c=l(1778),i=l(4345),d=l(901),m=l(7809),x=l(8699),u=l(1073),h=l(7713),f=l(8036),p=l(7845),v=l(5822).V,b=e([d,f,p]);[d,f,p]=b.then?(await b)():b;const{deleteGroup:g}=await v("@scripts/groupChats"),{getContext:j}=SillyTavern,w=({entity:e})=>{const[a,l]=(0,t.useState)(e.item||null),{closeModal:s}=(0,t.useContext)(c.Vs);(0,t.useEffect)(()=>{l(e.item||null)},[e]);const v=(0,t.useCallback)(()=>{s()},[s]),b=(0,t.useCallback)(async()=>{e?.id&&(await g(e.id.toString()),s())},[e,s]),w=(0,t.useCallback)(async()=>{if(!e?.id||!a)return;const l=j().groups.findIndex(a=>a.id===e.id);-1!==l&&(j().groups[l]=a),await(0,p.B)(a,!0),s()},[e,a,s]),N=(0,t.useMemo)(()=>{if(!a?.members)return[];const e=[];for(const l of a.members){if(!l)continue;const a=j().characters.find(e=>e.avatar===l);a&&e.push(a)}return e},[a]);return(0,r.jsxs)(o.A,{children:[(0,r.jsx)(o.A.Header,{children:"Edit Group"}),(0,r.jsxs)(o.A.Content,{children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,r.jsx)("div",{className:"shrink-0 w-16 h-16",children:(0,r.jsx)(d.A,{groupItem:e.item,width:64,height:64,rounded:!0})}),(0,r.jsxs)("div",{className:"flex flex-col grow",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Group Name"}),(0,r.jsx)(i.default,{defaultValue:e.item?.name||"",onChange:()=>{}})]})]}),(0,r.jsx)(m.default,{className:"my-4"}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col  gap-2",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Member Order:"}),(0,r.jsx)(x.A,{value:a.generation_mode,options:[{label:"Manual",value:2},{label:"Natural order",value:0},{label:"List Order",value:1},{label:"Pooled Order",value:3}]})]}),(0,r.jsxs)("div",{className:"flex flex-col  gap-2",children:[(0,r.jsx)("label",{className:"block mb-2 font-medium",children:"Generation Handling:"}),(0,r.jsx)(x.A,{value:a.generation_mode,options:[{label:"Swap character cards",value:0},{label:"Join character cards (exclude muted)",value:1},{label:"Join character cards (include muted)",value:2}]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(u.default,{label:"Allow Self responses",checked:a.allow_self_responses}),(0,r.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,r.jsx)(u.default,{label:"Auto Mode",checked:a.allow_self_responses}),(0,r.jsx)(i.default,{type:"number",placeholder:"5",value:a.auto_mode_delay,onChange:()=>{}})]}),(0,r.jsx)(u.default,{label:"Hide Muted Members Sprites",checked:!1}),(0,r.jsx)(u.default,{label:"Universal Tracker",checked:!1})]}),(0,r.jsx)("div",{children:(0,r.jsx)(h.default,{title:"Current Members",children:(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsx)(f.A,{members:N,onOrderChange:(e,s)=>{const r=a?.members||[],t=r.indexOf(e.avatar||"");if(-1===t)return;const n="up"===s?t-1:t+1;if(n<0||n>=r.length)return;const o=[...r],c=o[t];o[t]=o[n]??"",o[n]=c??"",l(e=>e?{...e,members:o}:e)},onRemoveMember:e=>{const s=(a?.members||[]).filter(a=>a!==e.avatar);l(e=>e?{...e,members:s}:e)},onOpenMemberProfile:e=>{console.log("Open profile for character:",e)}})})})}),(0,r.jsx)("div",{children:(0,r.jsx)(h.default,{title:"Add Members",children:(0,r.jsx)("div",{className:"flex flex-col gap-2",children:"TODO"})})})]})]}),(0,r.jsxs)(o.A.Footer,{children:[(0,r.jsx)("div",{className:"grow",children:(0,r.jsx)(n.A,{look:n.m.DANGER,onClick:b,children:"Delete"})}),(0,r.jsx)(n.A,{look:n.m.TRANSPARENT,onClick:v,children:"Cancel"}),(0,r.jsx)(n.A,{onClick:w,children:"Save"})]})]})};s()}catch(e){s(e)}},1)},1073(e,a,l){l.r(a),l.d(a,{default:()=>t});var s=l(5656),r=l(7140);const t=(0,r.memo)(({label:e,checked:a=!1,onChange:l})=>{const[t,n]=(0,r.useState)(a),o=(0,r.useCallback)(e=>{e.stopPropagation();const a=!t;n(a),l&&l(a)},[t,l]);return(0,r.useEffect)(()=>{n(a)},[a]),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"appearance-none opacity-0 w-6 h-6 left-0 m-0 p-0 top-0",style:{height:"24px !important",width:"24px !important",position:"absolute"},checked:t,onChange:o}),(0,s.jsx)("div",{className:`w-6 h-6  rounded flex items-center justify-center cursor-pointer ${t?"border-blurple":"border-white"} hover:border-blurple border-2`,style:{backgroundColor:t?"var(--color-blurple)":"transparent",border:t?"none":"2px solid var(--color-white)",transition:"all 0.2s ease-in-out"},children:(0,s.jsx)("svg",{"aria-hidden":"true",role:"img",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{fill:t?"white":"transparent",fillRule:"evenodd",d:"M19.06 6.94a1.5 1.5 0 0 1 0 2.12l-8 8a1.5 1.5 0 0 1-2.12 0l-4-4a1.5 1.5 0 0 1 2.12-2.12L10 13.88l6.94-6.94a1.5 1.5 0 0 1 2.12 0Z",clipRule:"evenodd"})})}),(0,s.jsx)("span",{className:"ml-2 text-gray-200",children:e})]})})})},7809(e,a,l){l.r(a),l.d(a,{default:()=>r});var s=l(5656);const r=({width:e="w-full",className:a=""})=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},className:`${e} h-px my-2 ml-auto mr-auto ${a}`})})},7845(e,a,l){l.a(e,async(e,s)=>{try{l.d(a,{B:()=>o});var r=l(5822).V;const{getRequestHeaders:t,getCharacters:n}=await r("@script");async function o(e,a=!0){await fetch("/api/groups/edit",{method:"POST",headers:t(),body:JSON.stringify(e)}),a&&await n()}s()}catch(c){s(c)}},1)},8036(e,a,l){l.a(e,async(e,s)=>{try{l.d(a,{A:()=>i});var r=l(5656),t=l(7140),n=l(5822).V;const{getThumbnailUrl:e}=await n("@script"),o=({member:a,onRemove:l,onOpenProfile:s,onOrderChange:n})=>{const o=(0,t.useMemo)(()=>e("avatar",a.avatar||"user-default.png"),[a]);return(0,r.jsxs)("div",{className:"flex flex-row items-center gap-4 p-2 border rounded-md",children:[(0,r.jsx)("div",{className:"w-10 h-10",children:(0,r.jsx)("img",{loading:"lazy",src:o,alt:a.name||"Member Avatar",className:"w-full h-full rounded-full object-cover"})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"font-medium",children:a.name||"Unnamed Member"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Tags: ",a.tags.join(", ")||"None"]})]}),(0,r.jsxs)("div",{className:"ml-auto flex flex-row gap-2 items-center",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1 w-6 items-center",children:[(0,r.jsx)("div",{children:(0,r.jsx)("div",{title:"Move Up",className:"fa fa-solid fa-arrow-up cursor-pointer",onClick:e=>{e.stopPropagation(),n&&n(a,"up")}})}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{title:"Move Down",className:"fa fa-solid fa-arrow-down cursor-pointer",onClick:e=>{e.stopPropagation(),n&&n(a,"down")}})})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1 w-6 items-center",children:(0,r.jsx)("div",{title:"Open Character Card",className:"fa fa-solid fa-user cursor-pointer",onClick:e=>{e.stopPropagation(),s&&s(a)}})}),(0,r.jsx)("div",{className:"flex flex-col gap-1 w-6 items-center",children:(0,r.jsx)("div",{title:"Remove Member",className:"fa fa-solid fa-trash cursor-pointer text-red-500",onClick:e=>{e.stopPropagation(),l&&l(a)}})})]})]})},c=({members:e,onOrderChange:a,onRemoveMember:l,onOpenMemberProfile:s})=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"flex flex-col gap-2",children:e&&e.map((e,t)=>(0,r.jsx)(o,{member:e,onOrderChange:a,onRemove:l,onOpenProfile:s},e.avatar||t))})}),i=(0,t.memo)(c);s()}catch(e){s(e)}},1)},8699(e,a,l){l.d(a,{A:()=>t});var s=l(5656),r=l(7140);const t=(0,r.memo)(({options:e=[],value:a,onChange:l,disabled:t})=>{const n=(0,r.useCallback)(e=>{l&&l(e.target.value)},[l]);return(0,s.jsx)("select",{className:"border border-gray-300 rounded bg-white disabled:bg-gray-100 disabled:cursor-not-allowed",value:a,onChange:n,disabled:t,children:e.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})})}};
//# sourceMappingURL=44.bundle.js.map