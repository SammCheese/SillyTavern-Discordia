export const __webpack_esm_id__=633;export const __webpack_esm_ids__=[633,713,809];export const __webpack_esm_modules__={2633(e,t,s){s.a(e,async(e,n)=>{try{s.r(t),s.d(t,{default:()=>m});var o=s(5656),a=s(7140),i=s(7229),c=s(5467),l=s(5822).V,r=e([i]),d=r.then?(await r)():r;i=d[0];const u=(0,a.lazy)(()=>s.e(53).then(s.bind(s,6053))),{saveSettingsDebounced:x}=await l("@script"),m=()=>{const{toggleExtension:e,categorizedExtensions:t}=(0,i.w)(),s=(0,a.useCallback)(async t=>{await e(t)},[e]),n=(0,a.useCallback)(()=>{x()},[]);return(0,o.jsx)(u,{title:"Extension Settings",onClose:n,children:(0,o.jsxs)("div",{className:"settings-section space-y-6",children:[t.system.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"System Extensions"}),(0,o.jsx)("div",{className:"space-y-2",children:t.system.map(e=>(0,o.jsx)(c.A,{extension:e,onToggle:s,settings:e.settings},e.name))})]}),t.global.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"Global Extensions"}),(0,o.jsx)("div",{className:"space-y-2",children:t.global.map(e=>(0,o.jsx)(c.A,{extension:e,onToggle:s,settings:e.settings},e.name))})]}),t.local.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-2xl font-semibold mb-4",children:"Local Extensions"}),(0,o.jsx)("div",{className:"space-y-2",children:t.local.map(e=>(0,o.jsx)(c.A,{extension:e,onToggle:s,settings:e.settings},e.name))})]})]})})};n()}catch(e){n(e)}},1)},5467(e,t,s){s.d(t,{A:()=>x});var n=s(5656),o=s(7140);const a=(0,o.memo)(({settings:e,disabled:t})=>{const s=(0,o.useRef)(null),a=(0,o.useRef)(null);return(0,o.useLayoutEffect)(()=>{const n=s.current;if(!n)return;if(a.current&&a.current.parentElement===n&&(n.removeChild(a.current),a.current=null),!e||0===e.length||t)return void(n.innerHTML="");const o=e.clone(!0).get(0);return o?(n.innerHTML="",n.appendChild(o),a.current=o,()=>{a.current&&a.current.parentElement===n&&(n.removeChild(a.current),a.current=null)}):void 0},[e,t]),!e||t?(0,n.jsx)("div",{className:"text-gray-500 text-center py-2",children:t?"Extension Disabled":"No Settings Available"}):(0,n.jsx)("div",{ref:s,className:"settings-container overflow-auto max-h-96 overflow-x-hidden"})});var i=s(7393),c=s(7713),l=s(9488);var r=s(7809);const d=(0,o.memo)(({isOn:e,onToggle:t,onColor:s="var(--color-blurple)"})=>{const[a,i]=(0,o.useState)(e),c=(0,o.useCallback)(()=>{i(!a),t&&t()},[a,t]);return(0,n.jsx)("div",{onClick:c,style:{cursor:"pointer",width:"50px",height:"25px",borderRadius:"15px",backgroundColor:a?s:"#ccc",position:"relative",transition:"background-color 0.2s"},children:(0,n.jsx)("div",{style:{position:"absolute",top:"2.5px",left:a?"27.5px":"2.5px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"#fff",transition:"left 0.2s",boxShadow:"0 0 2px rgba(0, 0, 0, 0.2)"}})})}),u=(0,o.memo)(function({extension:e,onToggle:t,settings:s}){const[u,x]=(0,o.useState)(e.name),[m,h]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let t=!0;return async function(e){const t={},s=[];for(const n of e){const e=new Promise((e,s)=>{fetch(`/scripts/extensions/${n}/manifest.json`).then(async o=>{if(o.ok){const s=await o.json();t[n]=s,e(s)}else s()}).catch(e=>{s(),console.log("Could not load manifest.json for "+n,e)})});s.push(e)}return await Promise.allSettled(s),t}([e.name]).then(s=>{t&&(x(s[e.name]?.display_name||e.name),h(!1))}),()=>{t=!1}},[]);const g=(0,o.useCallback)(()=>{t(e)},[t,e]);return m?(0,n.jsx)(c.default,{title:(0,n.jsx)(l.A,{width:150}),children:(0,n.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,n.jsx)("label",{children:(0,n.jsx)(l.A,{width:60})}),(0,n.jsx)(l.A,{width:40,height:20})]})}):(0,n.jsx)(c.default,{title:u,children:(0,n.jsx)(i.A,{children:(0,n.jsxs)("div",{className:"p-4 flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 justify-between",children:[(0,n.jsx)("label",{htmlFor:`${e.name}-enabled`,children:" Enabled "}),(0,n.jsx)(d,{isOn:!e.disabled,onToggle:g})]}),(0,n.jsx)(r.default,{}),(0,n.jsx)(a,{settings:s,disabled:e.disabled})]})})})}),x=(0,o.memo)(u)},5803(e,t,s){async function n(){try{const e=await fetch("/api/extensions/discover");if(e.ok){return await e.json()}return[]}catch(e){return console.error(e),[]}}async function o(e){const t=window.discordia.extensionTemplates||[],s=[];for(const n of t){const t=n.find(".inline-drawer-content");if(0===t.length)continue;const o=t.find("input, select, textarea, button");if(0===o.length)continue;const a={};o.each((e,t)=>{const s=t.getAttribute("discordia-settings-owner")||"unknown";a[s]=(a[s]||0)+1});let i="unknown",c=0;for(const[e,t]of Object.entries(a))t>c&&(c=t,i=e);e&&!e.includes(i)||(t.attr("style","width: 100%; box-sizing: border-box; display: block;"),s.push({name:i,elem:t}))}return s}s.d(t,{bc:()=>o,qM:()=>n})},7229(e,t,s){s.a(e,async(e,n)=>{try{s.d(t,{w:()=>u});var o=s(7140),a=s(5803),i=s(3696),c=s(5822).V;const{enableExtension:e,disableExtension:l}=await c("@scripts/extensions"),{saveSettingsDebounced:r,eventSource:d}=await c("@script"),u=()=>{const[t,s]=(0,o.useState)(null),[n,u]=(0,o.useState)([]),[x,m]=(0,o.useState)({local:[],global:[],system:[]}),[h,g]=(0,o.useState)([]);(0,o.useEffect)(()=>{(async()=>{const{extension_settings:e}=await c("@scripts/extensions"),t=e.disabledExtensions;g(t)})()},[]),(0,o.useEffect)(()=>{r()},[h]),(0,o.useEffect)(()=>{(async()=>{const e=await(0,a.qM)();u(e)})()},[]);const f=(0,o.useMemo)(()=>t&&0!==t.length?n.map(e=>{const s=t.find(t=>e.name.replace("third-party/","")===t.name)?.elem;return s?{...e,settings:s}:e}):n,[n,t]);(0,o.useEffect)(()=>{const e={local:[],global:[],system:[]};f.forEach(t=>{const s=t.type in e?t.type:"local";e[s].push({...t,type:s,settings:t.settings,disabled:h.includes(t.name)})}),m(e)},[f,h]),(0,o.useEffect)(()=>{const e=async()=>{const e=await(0,a.bc)();s(e)};return d.on(i.V.EXTENSION_HTML_POPULATED,e),e(),()=>{d.removeListener(i.V.EXTENSION_HTML_POPULATED,e)}},[]);return{settingsRecord:t,extensions:f,disabledExtensions:h,toggleExtension:async t=>{try{t.disabled?(await e(t.name,!1),g(e=>e.filter(e=>e!==t.name))):(await l(t.name,!1),g(e=>[...e,t.name]))}catch(e){throw console.error("Failed to toggle extension:",e),e}},categorizedExtensions:x}};n()}catch(e){n(e)}},1)},7713(e,t,s){s.r(t),s.d(t,{Accordion:()=>a,default:()=>i});var n=s(5656),o=s(7140);const a=({title:e,isOpen:t=!1,onToggle:s,children:a,destroyOnClose:i=!1})=>{const[c,l]=(0,o.useState)(t);(0,o.useEffect)(()=>{l(t)},[t]);const r=(0,o.useCallback)(()=>{l(e=>!e),s&&s()},[s]);return(0,n.jsxs)("div",{className:"accordion rounded mb-4 border border-base-discordia-lighter overflow-hidden",children:[(0,n.jsxs)("button",{className:"accordion-header cursor-pointer w-full flex justify-between items-center p-2 bg-accordion-header hover:bg-lighter transition-colors duration-200",onClick:r,children:[(0,n.jsx)("span",{className:"text-lg font-medium",children:e}),(0,n.jsx)("span",{className:"transition-transform duration-200 "+(c?"rotate-180":""),children:(0,n.jsx)("div",{className:"fa fa-chevron-down"})})]}),(0,n.jsx)("div",{className:"accordion-content bg-input-bg transition-all duration-200 "+(c?"block p-4":"hidden"),children:(c||!i)&&a})]})},i=(0,o.memo)(a)},7809(e,t,s){s.r(t),s.d(t,{default:()=>o});var n=s(5656);const o=(0,s(7140).memo)(({width:e="w-full",className:t=""})=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},className:`${e} h-px my-2 mx-auto ${t}`})}))}};
//# sourceMappingURL=633.bundle.js.map