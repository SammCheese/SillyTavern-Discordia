export const __webpack_esm_id__=476;export const __webpack_esm_ids__=[476];export const __webpack_esm_modules__={476:(t,e,i)=>{i.a(t,async(t,n)=>{try{i.r(e),i.d(e,{default:()=>w});var a=i(259),s=i(363),r=i(636),c=i(675),d=i(257).V,l=t([c]),o=l.then?(await l)():l;c=o[0];const h=s.lazy(()=>i.e(800).then(i.bind(i,800))),u=s.lazy(()=>i.e(959).then(i.bind(i,959))),x=s.lazy(()=>i.e(824).then(i.bind(i,824))),{getGroupPastChats:y}=await d("@scripts/groupChats"),{getPastCharacterChats:p,characters:m,closeCurrentChat:f}=await d("@script"),g=s.memo(function({entity:t,index:e,isSelected:i,style:n,onClick:s}){return(0,a.jsx)("div",{style:n,className:"discord-entity-item character-button w-full h-fit flex justify-center py-1",id:`character-button-${t.id}`,title:t.item?.name||t.id,children:(0,a.jsx)(h,{entity:t,index:e,isSelected:i,onSelect:s})})}),C=({index:t,style:e,data:i})=>{const{entities:n,selectedIndex:s,handleItemClick:r}=i,c=n[t];return c?(0,a.jsx)(g,{index:t,entity:c,style:e,isSelected:s===t,onClick:r}):(0,a.jsx)("div",{style:e,className:"discord-entity-item character-button w-full h-fit flex justify-center py-1",children:(0,a.jsx)(u,{onClick:()=>{}})})},_=({entities:t})=>{const[e,i]=s.useState(null),n=(0,s.useCallback)(async()=>{i(null),await f()},[]),d=(0,s.useCallback)(async(t,e)=>{i(e);try{if("group"===t.type){const e=t.id.toString();if(!SillyTavern.getContext().groups.find(t=>t.id.toString()===e))return;await f();const i=await y(e);await(0,c.eS)({group:t,chat_id:i[0]?.file_id})}else{const e=m.findIndex(e=>e.avatar===t?.item?.avatar);if(-1===e)return;await f();const i=await p(e);await(0,c.yG)(e,i[0]?.file_id)}}catch(t){console.error("Error selecting entity:",t)}},[]);(0,s.useEffect)(()=>{const{characterId:e,groupId:n}=SillyTavern.getContext();if(null!=n){const e=t.findIndex(t=>"group"===t.type&&t.id.toString()===n.toString());i(-1!==e?e:null)}else if(void 0!==e&&parseInt(e)>=0){const n=t.findIndex(t=>"character"===t.type&&t.id.toString()===e.toString());i(-1!==n?n:null)}else i(null)},[t]);const l=(0,s.useMemo)(()=>({entities:t,selectedIndex:e,handleItemClick:d}),[t,e,d]);return(0,a.jsxs)("div",{id:"character-container",children:[(0,a.jsxs)("div",{id:"characters-header",children:[(0,a.jsx)(x,{onClick:n}),(0,a.jsx)("div",{id:"characters-divider",className:"divider"})]}),(0,a.jsx)("div",{id:"characters-list",className:"pt-0.5",children:t.length<50?(0,a.jsxs)(a.Fragment,{children:[t.map((t,i)=>(0,a.jsx)(g,{entity:t,index:i,isSelected:e===i,onClick:d,style:{}},t.id.toString())),(0,a.jsx)("div",{id:"characters-divider",className:"divider"}),(0,a.jsx)(u,{onClick:()=>{}})]}):(0,a.jsx)(r.B8,{rowComponent:C,rowCount:t.length+1,rowHeight:60,rowProps:{data:l},style:{width:"100%"},overscanCount:5})})]})},w=s.memo(_);n()}catch(t){n(t)}},1)}};
//# sourceMappingURL=476.bundle.js.map