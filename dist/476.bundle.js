"use strict";(self.webpackChunkst_discordia=self.webpackChunkst_discordia||[]).push([[476],{476:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.r(t),r.d(t,{default:()=>g});var a=r(363),n=r(756),c=r(675),l=r(257).V,d=e([c]),o=d.then?(await d)():d;c=o[0];const s=a.lazy(()=>r.e(800).then(r.bind(r,800))),h=a.lazy(()=>r.e(959).then(r.bind(r,959))),u=a.lazy(()=>r.e(824).then(r.bind(r,824))),{getGroupPastChats:m}=await l("@scripts/groupChats"),{getPastCharacterChats:y,characters:v,closeCurrentChat:f}=await l("@script"),g=({entities:e})=>{const[t,r]=a.useState(null),i=async e=>{try{const t=v.findIndex(t=>t.avatar===e?.item?.avatar);if(-1===t)return void console.error("Character not found for entity:",e);await f(),y(t).then(async e=>{await(0,c.yG)(t,e[0]?.file_id)})}catch(e){console.error("Error selecting character:",e)}},l=async e=>{try{const t=e.id.toString();if(!SillyTavern.getContext().groups.find(e=>e.id.toString()===t))return void console.error("Group not found for entity:",e);await f(),m(t).then(async t=>{await(0,c.eS)({group:e,chat_id:t[0]?.file_id})})}catch(e){console.error("Error selecting group:",e)}};a.useEffect(()=>{const{characterId:t,groupId:i}=SillyTavern.getContext();let a=null;if(null!=i){const t=e.findIndex(e=>"group"===e.type&&e.id.toString()===i.toString());a=-1!==t?t:null}else if(void 0!==t&&parseInt(t)>=0){const r=e.findIndex(e=>"character"===e.type&&e.id.toString()===t.toString());a=-1!==r?r:null}else a=null;r(a)},[e]);return a.createElement("div",{id:"character-container"},a.createElement("div",{id:"characters-header"},a.createElement(u,{onClick:async()=>{r(null),await f()}}),a.createElement("div",{id:"characters-divider",className:"divider"})),a.createElement("div",{id:"characters-list",className:"pt-0.5"},e.length<50?a.createElement(a.Fragment,null,e.map((e,n)=>a.createElement("div",{className:"discord-entity-item character-button w-full h-fit",id:`character-button-${e.id}`,title:e.item?.name||e.id,key:n,onClick:()=>(r(n),"group"===e.type?void l(e):void i(e))},a.createElement(s,{entity:e,isSelected:t===n}))),a.createElement("div",{id:"characters-divider",className:"divider"}),a.createElement(h,{onClick:()=>{}})):a.createElement(n.B8,{width:80,height:window.innerHeight-120,rowCount:e.length+1,rowHeight:60,rowRenderer:({index:n,key:c,style:d})=>{const o=e[n];return o?a.createElement("div",{key:c,style:d,className:"discord-entity-item character-button w-full h-fit",id:`character-button-${o?.id}`,title:o?.item?.name||o?.id,onClick:()=>(r(n),"group"===o?.type?void l(o):void i(o))},a.createElement(s,{entity:o,isSelected:t===n})):a.createElement("div",{key:c,style:d,className:"w-full h-fit flex flex-col items-center"},a.createElement("div",{id:"characters-divider",className:"divider"}),a.createElement(h,{onClick:()=>{}}))},overscanRowCount:5,scrollToIndex:null!==t?t:void 0})))};i()}catch(e){i(e)}},1)}}]);
//# sourceMappingURL=476.bundle.js.map